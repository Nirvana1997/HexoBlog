---
title: Effective C++笔记(四)
category:
  - c++
tags:
  - c++
  - 学习笔记
date: 2022-07-19 12:41:41
---

第四章~
<!-- more -->

## 条款18：让接口容易被正确使用，不易被误用

这点无论在什么语言中都是很重要的规则。

总之要尽可能避免可能的错误，阻止误用，可以通过建立新类型、限制类型，限制传入值等方法。

然后可以通过`shared_ptr`去管理新建的对象，从而防止内存泄漏的风险，同时可以防范DLL问题，可以被用来自动解除互斥锁等。

## 条款19：设计class犹如type

这一条款其实非常宏观，核心思想就是对于设计class要十分谨慎，思考的角度要尽可能全面。作者给出的方式就是思考一系列问题（比较难概括，最好看原文）：

> * 新type的对象应该如何被创建和销毁？
> * 对象的初始化和对象的赋值该有什么样的差别？
> * 新type的对象如果被passed by value，意味着什么？
> * 什么是新type的“合法值”？
> * 你的新type需要配合某个继承图系吗？
> * 你的新type需要什么样的转换？
> * 什么样的操作符和函数对此新type而言是合理的？
> * 什么样的标准函数应被驳回？
> * 谁改取用新type的成员？
> * 什么是新type的“未声明接口”？
> * 你的新type有多么一般化？
> * 你真的需要一个新type吗？

## 条款20：宁以pass-by-reference-to-const替换pass_by_value

## 条款21：必须返回对象时，别妄想返回其reference

这两点其实从现在的眼光来看有些平常了，学c++的引用的时候大概率都会了解到。总的来说，传值时对非基础类型来说尽量传递const引用，因为直接传值会默认使用copy传值的方式传递，会有额外开销。然后不要返回指向local stack对象的指针或引用，这点也是老生常谈了。
