---
title: epoll的实现机制
category:
  - Linux
tags:
  - Linux
  - epoll
date: 2018-11-01 17:26:44
---

## 1.前言

昨天弄懂了epoll是干啥的,今天来研究下它是怎么实现的以及怎么用的.

<!-- more -->

## 2.select和poll

读了很多讲解epoll的文章,几乎都会提到select和poll,因为他们做的事是相同的,就是实现IO多路复用.

IO多路复用简单来说就是使用一个进程同时处理多个流,在服务器上"流"通常是socket.所以IO多路复用的核心问题便是怎么处理这多个流,要知道是否有需要处理的流,现在需要处理哪个流.

select和poll的实现便是遍历去判断每个流是否需要处理.当遇到某个流需要处理时,便唤醒处理进程.在调用select和poll时,会将监控的流的fds拷贝到内存空间.

由于这样的实现,使得select和poll会产生以下问题:

因为需要拷贝操作和遍历,随着fds中的文件描述符数目增长,耗费的性能会线性增长,而且select监控的文件描述符有1024的限制.poll解决了1024这一限制,但性能的问题依旧没能解决,所以最终都被epoll所代替了.

### 3.epoll

重点来了,因为poll没能解决select的性能问题,所以出现了epoll.

上面提到select和poll的性能问题,主要是因为两个原因:fds的拷贝和对fds的遍历,下面就来看看epoll如何解决这两个问题.

